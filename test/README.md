# TX-COS-MCP 测试文件说明

此目录包含 TX-COS-MCP 项目的所有测试文件，用于验证各项功能的正确性和可靠性。

## 测试文件列表

### 基础测试

- **`test.js`** - COS服务基础功能测试
  - 验证配置读取和服务初始化
  - 测试基本的上传和文件操作功能
  - 确保错误处理机制正常工作

### 协议合规性测试

- **`test-mcp.js`** - MCP协议合规性测试
  - 验证MCP服务器启动和通信
  - 测试标准输出纯净性
  - 确保协议响应格式正确

### 临时文件管理测试

- **`test-temp.js`** - 临时目录管理功能测试
  - 验证临时目录结构创建
  - 测试进度文件保存和读取
  - 确保目录权限和访问正常

- **`test-cleanup.js`** - 临时文件清理功能测试
  - 验证上传完成后的文件清理
  - 测试异常情况下的资源回收
  - 确保磁盘空间不泄漏

- **`test-path-validation.js`** - 文件路径验证功能测试
  - 验证路径空格字符清理
  - 测试中文文件名支持
  - 确保路径处理的健壮性

## 运行测试

### 单独运行

```bash
# 基础功能测试
npm run test

# MCP协议测试
npm run test:mcp

# 临时目录管理测试
npm run test:temp

# 临时文件清理测试
npm run test:cleanup

# 文件路径验证测试
npm run test:path
```

### 批量运行

```bash
# 运行所有测试
npm run test && npm run test:mcp && npm run test:temp && npm run test:cleanup && npm run test:path
```

## 测试环境要求

- Node.js v18+
- 有效的腾讯云COS配置（仅部分测试需要）
- 足够的磁盘空间用于临时文件测试

## 测试覆盖范围

- ✅ **配置管理** - 环境变量读取和验证
- ✅ **文件上传** - 单文件、批量、分片上传
- ✅ **文件操作** - 复制、移动、删除、重命名
- ✅ **文件夹管理** - 创建、删除、列举、统计
- ✅ **URL生成** - 临时签名链接
- ✅ **进度管理** - 断点续传进度持久化
- ✅ **资源清理** - 临时文件自动清理
- ✅ **路径处理** - 空格清理和中文文件名支持
- ✅ **错误处理** - 异常情况和重试机制
- ✅ **MCP协议** - 标准输出和响应格式

## 注意事项

1. **网络依赖**: 部分测试需要访问腾讯云COS服务
2. **文件权限**: 确保测试进程有创建临时文件的权限
3. **清理机制**: 测试会自动清理产生的临时文件
4. **配置安全**: 请勿在测试中使用生产环境的敏感配置

## 测试输出

测试脚本会提供详细的执行信息：
- ✅ 成功步骤显示绿色对勾
- ⚠️  警告信息显示黄色警告符号
- ❌ 失败步骤显示红色叉号
- 📊 统计信息以结构化JSON格式显示